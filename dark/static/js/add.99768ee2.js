(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["add"],{"2d98":function(e,t,a){"use strict";a.r(t);var n=a("7a23"),c={class:""},l=Object(n["m"])("首页"),o=Object(n["m"])("商品管理"),r=Object(n["m"])("商品列表"),b=Object(n["m"])("添加商品"),u=Object(n["m"])("点击上传"),d=Object(n["n"])("div",{class:"el-upload__tip"}," 只能上传 jpg/png 文件，且不超过 500kb ",-1),s=Object(n["m"])("添加商品");function i(e,t,a,i,j,O){var m=Object(n["N"])("el-breadcrumb-item"),p=Object(n["N"])("el-breadcrumb"),f=Object(n["N"])("el-alert"),g=Object(n["N"])("el-step"),_=Object(n["N"])("el-steps"),h=Object(n["N"])("el-input"),v=Object(n["N"])("el-form-item"),V=Object(n["N"])("el-cascader"),w=Object(n["N"])("el-tab-pane"),y=Object(n["N"])("el-checkbox"),N=Object(n["N"])("el-checkbox-group"),k=Object(n["N"])("el-button"),F=Object(n["N"])("el-upload"),C=Object(n["N"])("QuillEditor"),I=Object(n["N"])("el-tabs"),D=Object(n["N"])("el-form"),T=Object(n["N"])("el-card"),U=Object(n["N"])("el-dialog");return Object(n["E"])(),Object(n["j"])("div",c,[Object(n["n"])(p,{"separator-class":"el-icon-arrow-right"},{default:Object(n["cb"])((function(){return[Object(n["n"])(m,{to:{path:"/home"}},{default:Object(n["cb"])((function(){return[l]})),_:1}),Object(n["n"])(m,null,{default:Object(n["cb"])((function(){return[o]})),_:1}),Object(n["n"])(m,null,{default:Object(n["cb"])((function(){return[r]})),_:1}),Object(n["n"])(m,null,{default:Object(n["cb"])((function(){return[b]})),_:1})]})),_:1}),Object(n["n"])(T,null,{default:Object(n["cb"])((function(){return[Object(n["n"])(f,{title:"添加商品信息",type:"info","show-icon":"",closable:!1,center:""}),Object(n["n"])(_,{space:200,active:e.activeIndex,"finish-status":"success","align-center":"","process-status":"process"},{default:Object(n["cb"])((function(){return[Object(n["n"])(g,{title:"基本信息"}),Object(n["n"])(g,{title:"商品参数"}),Object(n["n"])(g,{title:"商品属性"}),Object(n["n"])(g,{title:"商品图片"}),Object(n["n"])(g,{title:"商品内容"}),Object(n["n"])(g,{title:"完成"})]})),_:1},8,["active"]),Object(n["n"])(D,{model:e.addForms,rules:e.addRules,ref:"addForm","label-width":"100px","label-position":"top"},{default:Object(n["cb"])((function(){return[Object(n["n"])(I,{"tab-position":"left",modelValue:e.activeIndex,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.activeIndex=t}),"before-leave":e.handleBeforeLeave,onTabClick:e.handleTabClick},{default:Object(n["cb"])((function(){return[Object(n["n"])(w,{label:"基本信息",name:"0"},{default:Object(n["cb"])((function(){return[Object(n["n"])(v,{label:"商品名称",prop:"goods_name"},{default:Object(n["cb"])((function(){return[Object(n["n"])(h,{modelValue:e.addForms.goods_name,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.addForms.goods_name=t}),type:"string"},null,8,["modelValue"])]})),_:1}),Object(n["n"])(v,{label:"商品价格",prop:"goods_price"},{default:Object(n["cb"])((function(){return[Object(n["n"])(h,{modelValue:e.addForms.goods_price,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.addForms.goods_price=t}),type:"number"},null,8,["modelValue"])]})),_:1}),Object(n["n"])(v,{label:"商品重量",prop:"goods_weight"},{default:Object(n["cb"])((function(){return[Object(n["n"])(h,{modelValue:e.addForms.goods_weight,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.addForms.goods_weight=t}),type:"number"},null,8,["modelValue"])]})),_:1}),Object(n["n"])(v,{label:"商品数量",prop:"goods_number"},{default:Object(n["cb"])((function(){return[Object(n["n"])(h,{modelValue:e.addForms.goods_number,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.addForms.goods_number=t}),type:"number"},null,8,["modelValue"])]})),_:1}),Object(n["n"])(v,{label:"商品分类"},{default:Object(n["cb"])((function(){return[Object(n["n"])(V,{modelValue:e.addForms.goods_cat,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.addForms.goods_cat=t}),options:e.state.cateList,props:e.cateProps,onChange:e.handleChange,placeholder:"请选择"},null,8,["modelValue","options","props","onChange"])]})),_:1})]})),_:1}),Object(n["n"])(w,{label:"商品参数",name:"1"},{default:Object(n["cb"])((function(){return[(Object(n["E"])(!0),Object(n["j"])(n["b"],null,Object(n["L"])(e.state.manyTableData,(function(e){return Object(n["E"])(),Object(n["j"])(v,{label:e.attr_name,key:e.attr_id},{default:Object(n["cb"])((function(){return[Object(n["n"])(N,{modelValue:e.attr_vals,"onUpdate:modelValue":function(t){return e.attr_vals=t}},{default:Object(n["cb"])((function(){return[(Object(n["E"])(!0),Object(n["j"])(n["b"],null,Object(n["L"])(e.attr_vals,(function(e,t){return Object(n["E"])(),Object(n["j"])(y,{label:e,key:t,border:"",checked:!0},null,8,["label"])})),128))]})),_:2},1032,["modelValue","onUpdate:modelValue"])]})),_:2},1032,["label"])})),128))]})),_:1}),Object(n["n"])(w,{label:"商品属性",name:"2"},{default:Object(n["cb"])((function(){return[(Object(n["E"])(!0),Object(n["j"])(n["b"],null,Object(n["L"])(e.state.onlyTableData,(function(e){return Object(n["E"])(),Object(n["j"])(v,{label:e.attr_name,key:e.attr_id},{default:Object(n["cb"])((function(){return[Object(n["n"])(h,{modelValue:e.attr_vals,"onUpdate:modelValue":function(t){return e.attr_vals=t}},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1032,["label"])})),128))]})),_:1}),Object(n["n"])(w,{label:"商品图片",name:"3"},{default:Object(n["cb"])((function(){return[Object(n["n"])(F,{action:"https://lianghj.top:8888/api/private/v1/upload","on-preview":e.handlePreview,"on-remove":e.handleRemove,"list-type":"picture",headers:e.headersObj,"on-success":e.handleSuccess},{tip:Object(n["cb"])((function(){return[d]})),default:Object(n["cb"])((function(){return[Object(n["n"])(k,{size:"small",type:"primary"},{default:Object(n["cb"])((function(){return[u]})),_:1})]})),_:1},8,["on-preview","on-remove","headers","on-success"])]})),_:1}),Object(n["n"])(w,{label:"商品内容",name:"4"},{default:Object(n["cb"])((function(){return[Object(n["n"])(C,{theme:"snow",ref:"qe"},null,512),Object(n["n"])(k,{type:"primary",class:"btns",onClick:e.commit},{default:Object(n["cb"])((function(){return[s]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["modelValue","before-leave","onTabClick"])]})),_:1},8,["model","rules"])]})),_:1}),Object(n["n"])(U,{title:"预览",modelValue:e.state.previewDialogVisible,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.state.previewDialogVisible=t}),width:"50%"},{footer:Object(n["cb"])((function(){return[Object(n["n"])("img",{src:e.state.imgPath,alt:"",class:"img"},null,8,["src"])]})),_:1},8,["modelValue"])])}var j=a("6c02"),O=a("22b6"),m=a("f930"),p=a("2ef0"),f=a.n(p),g=Object(n["o"])({name:"",components:{},setup(){const e=Object(j["c"])(),t=Object(n["p"])();let a=Object(n["J"])("0");const c=Object(n["I"])({cateList:[],manyTableData:[],onlyTableData:[],imgPath:"",previewDialogVisible:!1,oldGoods_introduce:""}),l=Object(n["I"])({label:"cat_name",value:"cat_id",children:"children",expandTrigger:"hover"}),o=Object(n["I"])({goods_name:"",goods_price:0,goods_weight:0,goods_number:0,goods_cat:[],pics:[],goods_introduce:"",attrs:[]}),r=Object(n["I"])({goods_name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],goods_price:[{required:!0,message:"请输入商品价格",trigger:"blur"}],goods_weight:[{required:!0,message:"请输入商品重量",trigger:"blur"}],goods_number:[{required:!0,message:"请输入商品数量",trigger:"blur"}]}),b=async()=>{const{data:e}=await Object(O["a"])(t).get("categories");if(200!==e.meta.status)return Object(m["a"])(t).error("获取分类列表失败");c.cateList=e.data};b();const u=()=>{3!==o.goods_cat.length&&(o.goods_cat=[])},d=(e,a)=>{if("0"===a&&3!==o.goods_cat.length)return Object(m["a"])(t).error("请先选择商品分类"),!1},s=Object(n["h"])(()=>3===o.goods_cat.length?o.goods_cat[2]:null),i=async()=>{if("1"===a.value){const{data:e}=await Object(O["a"])(t).get(`categories/${s.value}/attributes`,{params:{sel:"many"}});if(200!==e.meta.status)return Object(m["a"])(t).error("获取动态参数列表失败");e.data.forEach(e=>{0===e.attr_vals.length||e.attr_vals.split(" ")}),c.manyTableData=e.data}else if("2"===a.value){const{data:e}=await Object(O["a"])(t).get(`categories/${s.value}/attributes`,{params:{sel:"only"}});if(200!==e.meta.status)return Object(m["a"])(t).error("获取静态属性列表失败");c.onlyTableData=e.data}},p=e=>{c.imgPath=e.response.data.url,c.previewDialogVisible=!0},g=e=>{e.response.data.tmp_path;const t=o.pics.findIndex(e=>{e.pic});o.pics.splice(t,1)},_=Object(n["I"])({Authorization:window.sessionStorage.getItem("token")}),h=e=>{const t={pic:e.data.tmp_path};o.pics.push(t)},v=Object(n["J"])(null),V=Object(n["J"])(null),w=()=>{null!==v.value&&v.value.validate(async a=>{if(!a)return Object(m["a"])(t).error("请填写必填项，不可偷懒");const n=f.a.cloneDeep(o);n.goods_cat=n.goods_cat.join(","),null!==V.value&&(n.goods_introduce=V.value.getContents().ops[0].insert);const{data:c}=await Object(O["a"])(t).post("goods",n);if(201!==c.meta.status)return Object(m["a"])(t).error("添加商品失败");Object(m["a"])(t).success("添加商品成功"),e.push("/goods")})};return{activeIndex:a,addForms:o,addForm:v,addRules:r,state:c,getCateList:b,cateProps:l,handleChange:u,handleBeforeLeave:d,handleTabClick:i,cateId:s,handleRemove:g,handlePreview:p,headersObj:_,handleSuccess:h,commit:w,qe:V}}});a("5b92");g.render=i;t["default"]=g},"5b92":function(e,t,a){"use strict";a("6987")},6987:function(e,t,a){}}]);
//# sourceMappingURL=add.99768ee2.js.map