(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["roles"],{"159b":function(e,t,n){var r=n("da84"),c=n("fdbc"),o=n("17c2"),a=n("9112");for(var u in c){var l=r[u],i=l&&l.prototype;if(i&&i.forEach!==o)try{a(i,"forEach",o)}catch(s){i.forEach=o}}},"17c2":function(e,t,n){"use strict";var r=n("b727").forEach,c=n("a640"),o=c("forEach");e.exports=o?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},"2ccd":function(e,t,n){},"6f5a":function(e,t,n){"use strict";n.r(t);var r=n("7a23"),c=Object(r["gb"])("data-v-603d5d43");Object(r["H"])("data-v-603d5d43");var o=Object(r["m"])("首页"),a=Object(r["m"])("权限管理"),u=Object(r["m"])("角色列表"),l=Object(r["m"])("添加角色"),i=Object(r["n"])("i",{class:"el-icon-caret-right"},null,-1),s=Object(r["n"])("i",{class:"el-icon-caret-right"},null,-1),f={class:"dialog-footer"},d=Object(r["m"])("取 消"),b=Object(r["m"])("确 定"),j={class:"dialog-footer"},O=Object(r["m"])("取 消"),m=Object(r["m"])("确 定"),p={class:"dialog-footer"},h=Object(r["m"])("取 消"),v=Object(r["m"])("确 定");Object(r["F"])();var w=c((function(e,t,n,w,g,k){var y=Object(r["N"])("el-breadcrumb-item"),R=Object(r["N"])("el-breadcrumb"),x=Object(r["N"])("el-button"),_=Object(r["N"])("el-col"),I=Object(r["N"])("el-row"),C=Object(r["N"])("el-tag"),N=Object(r["N"])("el-table-column"),E=Object(r["N"])("el-tooltip"),V=Object(r["N"])("el-table"),F=Object(r["N"])("el-input"),L=Object(r["N"])("el-form-item"),D=Object(r["N"])("el-form"),P=Object(r["N"])("el-dialog"),B=Object(r["N"])("el-tree"),T=Object(r["N"])("el-card");return Object(r["E"])(),Object(r["j"])("div",null,[Object(r["n"])(R,{"separator-class":"el-icon-arrow-right"},{default:c((function(){return[Object(r["n"])(y,{to:{path:"/home"}},{default:c((function(){return[o]})),_:1}),Object(r["n"])(y,null,{default:c((function(){return[a]})),_:1}),Object(r["n"])(y,null,{default:c((function(){return[u]})),_:1})]})),_:1}),Object(r["n"])(T,null,{default:c((function(){return[Object(r["n"])(I,null,{default:c((function(){return[Object(r["n"])(_,null,{default:c((function(){return[Object(r["n"])(x,{type:"primary",onClick:w.isAddRole},{default:c((function(){return[l]})),_:1},8,["onClick"])]})),_:1})]})),_:1}),Object(r["n"])(V,{border:"",stripe:"",data:w.state.roleList,fit:""},{default:c((function(){return[Object(r["n"])(N,{type:"expand"},{default:c((function(e){return[(Object(r["E"])(!0),Object(r["j"])(r["b"],null,Object(r["L"])(e.row.children,(function(t,n){return Object(r["E"])(),Object(r["j"])(I,{key:t.id,class:["tagBot",0===n?"tagTop":""]},{default:c((function(){return[Object(r["n"])(_,{span:5},{default:c((function(){return[Object(r["n"])(C,{closable:"",onClose:function(n){return w.deletePowerById(e.row,t.id)}},{default:c((function(){return[Object(r["m"])(Object(r["R"])(t.authName),1)]})),_:2},1032,["onClose"]),i]})),_:2},1024),Object(r["n"])(_,{span:19},{default:c((function(){return[(Object(r["E"])(!0),Object(r["j"])(r["b"],null,Object(r["L"])(t.children,(function(t,n){return Object(r["E"])(),Object(r["j"])(I,{key:t.id},{default:c((function(){return[Object(r["n"])(_,{span:8},{default:c((function(){return[Object(r["n"])(C,{type:"success",closable:"",onClose:function(n){return w.deletePowerById(e.row,t.id)}},{default:c((function(){return[Object(r["m"])(Object(r["R"])(t.authName),1)]})),_:2},1032,["onClose"]),s]})),_:2},1024),Object(r["n"])(_,{span:16},{default:c((function(){return[(Object(r["E"])(!0),Object(r["j"])(r["b"],null,Object(r["L"])(t.children,(function(t,n){return Object(r["E"])(),Object(r["j"])(C,{type:"warning",key:t.id,closable:"",onClose:function(n){return w.deletePowerById(e.row,t.id)}},{default:c((function(){return[Object(r["m"])(Object(r["R"])(t.authName),1)]})),_:2},1032,["onClose"])})),128))]})),_:2},1024)]})),_:2},1024)})),128))]})),_:2},1024)]})),_:2},1032,["class"])})),128))]})),_:1}),Object(r["n"])(N,{label:"角色名称",prop:"roleName"}),Object(r["n"])(N,{label:"角色描述",prop:"roleDesc"}),Object(r["n"])(N,{label:"操作"},{default:c((function(e){return[Object(r["n"])(E,{class:"item",effect:"dark",content:"编辑",placement:"top",enterable:!1},{default:c((function(){return[Object(r["n"])(x,{type:"primary",icon:"el-icon-edit",size:"mini",onClick:function(t){return w.editRole(e.row.id)}},null,8,["onClick"])]})),_:2},1024),Object(r["n"])(E,{class:"item",effect:"dark",content:"删除",placement:"top",enterable:!1},{default:c((function(){return[Object(r["n"])(x,{type:"danger",icon:"el-icon-delete",size:"mini",onClick:function(t){return w.deleteRole(e.row.id)}},null,8,["onClick"])]})),_:2},1024),Object(r["n"])(E,{class:"item",effect:"dark",content:"设置",placement:"top",enterable:!1},{default:c((function(){return[Object(r["n"])(x,{type:"warning",icon:"el-icon-setting",size:"mini",onClick:function(t){return w.setPower(e.row)}},null,8,["onClick"])]})),_:2},1024)]})),_:1})]})),_:1},8,["data"]),Object(r["n"])(P,{title:"添加角色",modelValue:w.roleForm,"onUpdate:modelValue":t[4]||(t[4]=function(e){return w.roleForm=e})},{footer:c((function(){return[Object(r["n"])("span",f,[Object(r["n"])(x,{onClick:t[3]||(t[3]=function(e){return w.roleForm=!1})},{default:c((function(){return[d]})),_:1}),Object(r["n"])(x,{type:"primary",onClick:w.commitAddRole},{default:c((function(){return[b]})),_:1},8,["onClick"])])]})),default:c((function(){return[Object(r["n"])(D,{model:w.roleInfo,ref:"addRoleRef"},{default:c((function(){return[Object(r["n"])(L,{label:"角色名称"},{default:c((function(){return[Object(r["n"])(F,{modelValue:w.roleInfo.roleName,"onUpdate:modelValue":t[1]||(t[1]=function(e){return w.roleInfo.roleName=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1}),Object(r["n"])(L,{label:"角色描述"},{default:c((function(){return[Object(r["n"])(F,{modelValue:w.roleInfo.roleDesc,"onUpdate:modelValue":t[2]||(t[2]=function(e){return w.roleInfo.roleDesc=e}),autocomplete:"off"},null,8,["modelValue"])]})),_:1})]})),_:1},8,["model"])]})),_:1},8,["modelValue"]),Object(r["n"])(P,{title:"编辑角色",modelValue:w.isEditRoleForm,"onUpdate:modelValue":t[8]||(t[8]=function(e){return w.isEditRoleForm=e})},{footer:c((function(){return[Object(r["n"])("span",j,[Object(r["n"])(x,{onClick:t[7]||(t[7]=function(e){return w.isEditRoleForm=!1})},{default:c((function(){return[O]})),_:1}),Object(r["n"])(x,{type:"primary",onClick:w.commitEditRole},{default:c((function(){return[m]})),_:1},8,["onClick"])])]})),default:c((function(){return[Object(r["n"])(D,{model:w.state.roleInfo},{default:c((function(){return[Object(r["n"])(L,{label:"角色名称"},{default:c((function(){return[Object(r["n"])(F,{modelValue:w.state.roleInfo.roleName,"onUpdate:modelValue":t[5]||(t[5]=function(e){return w.state.roleInfo.roleName=e})},{default:c((function(){return[Object(r["m"])(Object(r["R"])(w.state.roleList.roleName),1)]})),_:1},8,["modelValue"])]})),_:1}),Object(r["n"])(L,{label:"角色描述"},{default:c((function(){return[Object(r["n"])(F,{modelValue:w.state.roleInfo.roleDesc,"onUpdate:modelValue":t[6]||(t[6]=function(e){return w.state.roleInfo.roleDesc=e})},{default:c((function(){return[Object(r["m"])(Object(r["R"])(w.state.roleList.roleDesc),1)]})),_:1},8,["modelValue"])]})),_:1})]})),_:1},8,["model"])]})),_:1},8,["modelValue"]),Object(r["n"])(P,{title:"修改权限",modelValue:w.isSetForm,"onUpdate:modelValue":t[10]||(t[10]=function(e){return w.isSetForm=e}),width:"30%",onClose:w.resetDefKeys},{footer:c((function(){return[Object(r["n"])("span",p,[Object(r["n"])(x,{onClick:t[9]||(t[9]=function(e){return w.isSetForm=!1})},{default:c((function(){return[h]})),_:1}),Object(r["n"])(x,{type:"primary",onClick:w.sllotPower},{default:c((function(){return[v]})),_:1},8,["onClick"])])]})),default:c((function(){return[Object(r["n"])(B,{data:w.state.rightList,props:w.TreeProps,"show-checkbox":"","node-key":"id","default-expand-all":"","default-checked-keys":w.state.defKeys,ref:"treeRef"},null,8,["data","props","default-checked-keys"])]})),_:1},8,["modelValue","onClose"]),Object(r["n"])("div",null,Object(r["R"])(w.state.roleList.id),1)]})),_:1})])})),g=n("2909"),k=n("1da1"),y=(n("99af"),n("159b"),n("a15b"),n("96cf"),n("22b6")),R=n("f930"),x=n("ee83"),_={name:"",setup:function(e){var t=Object(r["p"])(),n=Object(r["I"])({roleList:[],roleInfo:{},rightList:[],defKeys:[],roleId:""}),c=Object(r["I"])({roleName:"",roleDesc:""}),o=function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(){var r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(y["a"])(t).get("roles");case 2:if(r=e.sent,c=r.data,200==c.meta.status){e.next=6;break}return e.abrupt("return",Object(R["a"])(t).error("获取角色列表失败"));case 6:n.roleList=c.data;case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();o();var a=Object(r["J"])(!1),u=function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a.value=!0;case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(y["a"])(t).post("roles",c);case 2:if(n=e.sent,r=n.data,201===r.meta.status){e.next=6;break}return e.abrupt("return",Object(R["a"])(t).error("添加角色失败"));case 6:return a.value=!1,o(),e.abrupt("return",Object(R["a"])(t).success("添加角色成功"));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=Object(r["J"])(!1),s=function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(r){var c,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i.value=!0,e.next=3,Object(y["a"])(t).get("roles/"+r);case 3:if(c=e.sent,o=c.data,200==o.meta.status){e.next=7;break}return e.abrupt("return",Object(R["a"])(t).error("查询角色失败"));case 7:n.roleInfo=o.data;case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(){var r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(y["a"])(t).put("roles/"+n.roleInfo.roleId,{roleName:n.roleInfo.roleName,roleDesc:n.roleInfo.roleDesc});case 2:if(r=e.sent,c=r.data,200===c.meta.status){e.next=6;break}return e.abrupt("return",Object(R["a"])(t).error("修改角色失败"));case 6:return i.value=!1,o(),e.abrupt("return",Object(R["a"])(t).success("修改角色成功"));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(n){var r,c,a,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=Object(x["a"])(t),e.next=3,r.confirm("此操作将永久删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 3:if(c=e.sent,"confirm"===c){e.next=6;break}return e.abrupt("return",Object(R["a"])(t).info("已取消删除操作"));case 6:return e.next=8,Object(y["a"])(t).delete("roles/"+n);case 8:if(a=e.sent,u=a.data,200==u.meta.status){e.next=12;break}return e.abrupt("return",Object(R["a"])(t).error("删除角色失败"));case 12:return o(),e.abrupt("return",Object(R["a"])(t).success("删除角色成功"));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(n,r){var c,o,a,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return c=Object(x["a"])(t),e.next=3,c.confirm("此操作将永久删除该权限, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 3:if(o=e.sent,"confirm"===o){e.next=6;break}return e.abrupt("return",Object(R["a"])(t).info("已取消删除操作"));case 6:return e.next=8,Object(y["a"])(t).delete("roles/".concat(n.id,"/rights/").concat(r));case 8:if(a=e.sent,u=a.data,200===u.meta.status){e.next=12;break}return e.abrupt("return",Object(R["a"])(t).error("删除权限失败"));case 12:n.children=u.data,Object(R["a"])(t).success("删除权限成功");case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),j=function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(r){var c,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(y["a"])(t).get("rights/tree");case 2:c=e.sent,o=c.data,n.rightList=o.data,n.roleId=r.id,p(r,n.defKeys),O.value=!0;case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=Object(r["J"])(!1),m=Object(r["I"])({label:"authName",children:"children"}),p=function e(t,n){if(!t.children)return n.push(t.id);t.children.forEach((function(t){e(t,n)}))},h=function(){n.defKeys=[],n.roleId=""},v=Object(r["J"])(null),w=function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(){var c,a,u,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null===v.value){e.next=12;break}return c=Object(r["I"])([].concat(Object(g["a"])(v.value.getCheckedKeys()),Object(g["a"])(v.value.getHalfCheckedKeys()))),a=c.join(","),e.next=5,Object(y["a"])(t).post("roles/".concat(n.roleId,"/rights"),{rids:a});case 5:if(u=e.sent,l=u.data,200===l.meta.status){e.next=9;break}return e.abrupt("return",Object(R["a"])(t).error("分配权限失败"));case 9:return o(),O.value=!1,e.abrupt("return",Object(R["a"])(t).success("分配权限成功"));case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r["B"])((function(){w()})),{state:n,getRoleList:o,isAddRole:u,roleInfo:c,roleForm:a,commitAddRole:l,isEditRoleForm:i,editRole:s,commitEditRole:f,deleteRole:d,deletePowerById:b,setPower:j,isSetForm:O,TreeProps:m,resetDefKeys:h,treeRef:v,sllotPower:w}}};n("8830");_.render=w,_.__scopeId="data-v-603d5d43";t["default"]=_},8830:function(e,t,n){"use strict";n("2ccd")},"99af":function(e,t,n){"use strict";var r=n("23e7"),c=n("d039"),o=n("e8b5"),a=n("861d"),u=n("7b0b"),l=n("50c4"),i=n("8418"),s=n("65f0"),f=n("1dde"),d=n("b622"),b=n("2d00"),j=d("isConcatSpreadable"),O=9007199254740991,m="Maximum allowed index exceeded",p=b>=51||!c((function(){var e=[];return e[j]=!1,e.concat()[0]!==e})),h=f("concat"),v=function(e){if(!a(e))return!1;var t=e[j];return void 0!==t?!!t:o(e)},w=!p||!h;r({target:"Array",proto:!0,forced:w},{concat:function(e){var t,n,r,c,o,a=u(this),f=s(a,0),d=0;for(t=-1,r=arguments.length;t<r;t++)if(o=-1===t?a:arguments[t],v(o)){if(c=l(o.length),d+c>O)throw TypeError(m);for(n=0;n<c;n++,d++)n in o&&i(f,d,o[n])}else{if(d>=O)throw TypeError(m);i(f,d++,o)}return f.length=d,f}})},a15b:function(e,t,n){"use strict";var r=n("23e7"),c=n("44ad"),o=n("fc6a"),a=n("a640"),u=[].join,l=c!=Object,i=a("join",",");r({target:"Array",proto:!0,forced:l||!i},{join:function(e){return u.call(o(this),void 0===e?",":e)}})},a640:function(e,t,n){"use strict";var r=n("d039");e.exports=function(e,t){var n=[][e];return!!n&&r((function(){n.call(null,t||function(){throw 1},1)}))}},ee83:function(e,t,n){"use strict";function r(e){var t=e,n=t.appContext.config.globalProperties.$confirm;return n}n.d(t,"a",(function(){return r}))}}]);
//# sourceMappingURL=roles.cad30f23.js.map